<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live Cricket Score</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>

<style>
body {
  background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
  color: white;
  font-family: system-ui, sans-serif;
}
.glass {
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(14px);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 16px;
}
.team-score {
  font-size: 22px;
  font-weight: 800;
  color: #facc15;
}
</style>
</head>

<body class="p-4 max-w-3xl mx-auto space-y-5">

<!-- HEADER -->
<div class="text-center">
  <h1 id="matchTitle" class="text-2xl font-bold text-yellow-400">LIVE CRICKET SCORE</h1>
  <p id="matchSlug" class="text-xs text-gray-400 mt-1"></p>
</div>

<!-- SCORE -->
<div class="grid grid-cols-2 gap-4">
  <div class="glass p-4 text-center">
    <img id="t1flag" class="w-14 h-14 mx-auto mb-2 rounded-full">
    <div id="t1name" class="font-semibold"></div>
    <div class="team-score" id="t1score">--</div>
    <div class="text-xs text-gray-400" id="t1overs"></div>
  </div>

  <div class="glass p-4 text-center">
    <img id="t2flag" class="w-14 h-14 mx-auto mb-2 rounded-full">
    <div id="t2name" class="font-semibold"></div>
    <div class="team-score" id="t2score">--</div>
    <div class="text-xs text-gray-400" id="t2overs"></div>
  </div>
</div>

<!-- STATUS -->
<div class="glass p-4 text-center text-yellow-400 font-semibold" id="status">
  Loading match status...
</div>

<!-- BATTING -->
<div class="glass p-4">
  <h2 class="text-yellow-400 mb-2">Current Batsmen</h2>
  <div class="grid grid-cols-2 gap-3">
    <div id="bat1"></div>
    <div id="bat2"></div>
  </div>
</div>

<!-- BOWLING -->
<div class="glass p-4">
  <h2 class="text-yellow-400 mb-2">Current Bowlers</h2>
  <div class="grid grid-cols-2 gap-3">
    <div id="bowl1"></div>
    <div id="bowl2"></div>
  </div>
</div>

<!-- COMMENTARY -->
<div class="glass p-4 max-h-64 overflow-y-auto">
  <h2 class="text-yellow-400 mb-2">Live Commentary</h2>
  <div id="commentary" class="space-y-2 text-sm"></div>
</div>

<footer class="text-center text-xs text-gray-500 mt-6">
© 2025 Allrounder
</footer>

<script>
// ==========================
// GET SLUG FROM URL
// ==========================
const slug = location.pathname.split("/").pop();

// show slug
document.getElementById("matchSlug").textContent = slug.replace(/-/g, " ").toUpperCase();

// auto title
document.title = slug.replace(/-/g," ").toUpperCase() + " | Live Score";

// ==========================
// BUILD API DIRECTLY
// ==========================
const mainAPI =
  "https://cy-8i38.onrender.com/raw?url=" +
  encodeURIComponent(
    `https://cmc2.sportskeeda.com/live-cricket-score/${slug}/ajax`
  );

// ==========================
// FETCH DATA
// ==========================
async function fetchData() {
  try {
    const res = await fetch(mainAPI);
    const data = await res.json();

    const { score_strip, now_batting, now_bowling, info, commentary } = data;

    // teams
    t1name.textContent = score_strip[0].name;
    t2name.textContent = score_strip[1].name;
    t1flag.src = score_strip[0].team_flag;
    t2flag.src = score_strip[1].team_flag;

    t1score.textContent = score_strip[0].score || "Yet To Bat";
    t2score.textContent = score_strip[1].score || "Yet To Bat";
    t1overs.textContent = score_strip[0].overs ? `(${score_strip[0].overs})` : "";
    t2overs.textContent = score_strip[1].overs ? `(${score_strip[1].overs})` : "";

    // status
    status.innerHTML = `<i class="material-icons text-sm">live_tv</i> ${info}`;

    // batsmen
    bat1.innerHTML = `${now_batting.b1.name} - ${now_batting.b1.stats.runs} (${now_batting.b1.stats.balls})`;
    bat2.innerHTML = `${now_batting.b2.name} - ${now_batting.b2.stats.runs} (${now_batting.b2.stats.balls})`;

    // bowlers
    bowl1.innerHTML = `${now_bowling.b1.name} - ${now_bowling.b1.stats.overs} ov`;
    bowl2.innerHTML = `${now_bowling.b2.name} - ${now_bowling.b2.stats.overs} ov`;

    // commentary
    commentary.innerHTML = "";
    commentary.slice(0, 8).forEach(c => {
      commentary.innerHTML += `<div>• ${c.comment_text}</div>`;
    });

  } catch (e) {
    status.textContent = "Failed to load match";
    console.error(e);
  }
}

// ==========================
// INIT
// ==========================
fetchData();
setInterval(fetchData, 30000);
</script>

</body>
</html>
