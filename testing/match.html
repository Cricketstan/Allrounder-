<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>All Match Bets</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
body{background:#0b0f1a;color:#fff;padding:14px}
.market{
  background:linear-gradient(145deg,#151c30,#0f1424);
  border-radius:16px;
  padding:14px;
  margin-bottom:16px
}
.market h3{margin-bottom:10px}
.runner{
  display:flex;justify-content:space-between;
  margin:8px 0
}
.odd{padding:6px 10px;border-radius:8px;font-weight:800}
.back{background:#00ff88;color:#000}
.lay{background:#ff4d4d}
.suspend{opacity:.4}
</style>
</head>

<body>
<h2 id="title">Loadingâ€¦</h2>
<div id="markets"></div>

<script>
const id = new URLSearchParams(location.search).get("eventId");
const API =
  "https://central.zplay1.in/pb/api/v1/events/matchDetails/"+id;

function best(arr,type){
  if(!arr?.length) return null;
  return type==="max"
    ? Math.max(...arr.map(o=>o.p))
    : Math.min(...arr.map(o=>o.p));
}

fetch(API)
.then(r=>r.json())
.then(d=>{
  const match=d.data.match;
  document.getElementById("title").innerText=match.eventName;

  const box=document.getElementById("markets");
  box.innerHTML="";

  match.matchOddData.forEach(m=>{
    let html="";
    m.runners.forEach(r=>{
      const back=best(r.ex?.b,"max");
      const lay =best(r.ex?.l,"min");
      const name=
        m.runnerName?.find(x=>x.SID===r.sid)?.RN || "Runner";

      html+=`
        <div class="runner ${r.s!=="ACTIVE"?"suspend":""}">
          <div>${name}</div>
          <div>
            ${back?`<span class="odd back">${back}</span>`:""}
            ${lay?`<span class="odd lay">${lay}</span>`:""}
          </div>
        </div>`;
    });

    box.innerHTML+=`
      <div class="market">
        <h3>${m.marketName} (${m.st})</h3>
        ${html}
      </div>`;
  });
});
</script>
</body>
</html>
